<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AuthentiWave Prototype</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
        background-color: #111827; /* bg-gray-900 */
      }
      .card {
        background-color: #1f2937; /* bg-gray-800 */
        border: 1px solid #374151; /* border-gray-700 */
        border-radius: 0.75rem; /* rounded-xl */
        padding: 1.5rem;
        box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1),
          0 2px 4px -2px rgb(0 0 0 / 0.1);
        transition: all 0.3s ease;
      }
      .card-title {
        color: #9ca3af; /* text-gray-400 */
        font-weight: 500;
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
      }
      .card-title i {
        margin-right: 0.5rem;
        color: #6b7280; /* text-gray-500 */
      }
      .status-badge {
        padding: 0.5rem 1rem;
        border-radius: 9999px;
        font-weight: 600;
        font-size: 0.875rem;
        transition: all 0.3s ease;
      }
      .status-pending {
        background-color: #374151; /* bg-gray-700 */
        color: #d1d5db; /* text-gray-300 */
      }
      .status-approved {
        background-color: #059669; /* bg-green-600 */
        color: #d1fae5; /* text-green-100 */
      }
      .status-deceptive {
        background-color: #dc2626; /* bg-red-600 */
        color: #fee2e2; /* text-red-100 */
      }
      .uav-icon {
        transition: transform 0.5s ease, color 0.5s ease;
      }
      .uav-active {
        transform: scale(1.1) rotate(2deg);
        color: #34d399; /* text-green-400 */
      }
      .param-value {
        font-family: "monospace";
        font-size: 1.1rem;
        color: #f9fafb; /* text-gray-50 */
        background-color: #374151; /* bg-gray-700 */
        padding: 0.25rem 0.5rem;
        border-radius: 0.25rem;
      }
      .formula {
        font-family: "monospace";
        color: #e5e7eb; /* text-gray-200 */
        background-color: #111827; /* bg-gray-900 */
        padding: 1rem;
        border-radius: 0.5rem;
        border: 1px solid #374151; /* border-gray-700 */
      }
      input[type="range"] {
        -webkit-appearance: none;
        appearance: none;
        width: 100%;
        height: 8px;
        background: #374151; /* bg-gray-700 */
        border-radius: 5px;
        outline: none;
        opacity: 0.7;
        transition: opacity 0.2s;
      }
      input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 20px;
        height: 20px;
        background: #3b82f6; /* bg-blue-500 */
        cursor: pointer;
        border-radius: 50%;
      }
      input[type="range"]::-moz-range-thumb {
        width: 20px;
        height: 20px;
        background: #3b82f6; /* bg-blue-500 */
        cursor: pointer;
        border-radius: 50%;
      }
      .btn {
        padding: 0.75rem 1.5rem;
        border-radius: 0.5rem;
        font-weight: 600;
        transition: all 0.2s ease;
        display: inline-flex;
        align-items: center;
        justify-content: center;
      }
      .btn-ally {
        background-color: #1d4ed8; /* bg-blue-700 */
        color: white;
      }
      .btn-ally:hover {
        background-color: #1e40af; /* bg-blue-800 */
      }
      .btn-adversary {
        background-color: #991b1b; /* bg-red-800 */
        color: white;
      }
      .btn-adversary:hover {
        background-color: #7f1d1d; /* bg-red-900 */
      }
      .btn-learn {
        background-color: #047857; /* bg-green-700 */
        color: white;
      }
      .btn-learn:hover {
        background-color: #065f46; /* bg-green-800 */
      }
      .db-entry {
        background-color: #374151;
        padding: 0.5rem 1rem;
        border-radius: 0.375rem;
        font-family: monospace;
        color: #a5f3fc; /* text-cyan-200 */
        margin-bottom: 0.5rem;
        text-align: center;
      }
    </style>
  </head>
  <body class="text-gray-300">
    <div class="container mx-auto p-4 md:p-8">
      <!-- Header -->
      <div class="text-center mb-8">
        <h1 class="text-4xl font-bold text-white">AuthentiWave</h1>
        <p class="text-lg text-gray-400 mt-2">
          Signal Authentication & Verification Prototype
        </p>
      </div>

      <!-- Main Grid -->
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- Left Column: Controls & Fingerprint -->
        <div class="lg:col-span-2 space-y-6">
          <!-- Signal Source -->
          <div class="card">
            <h2 class="card-title">
              <i class="fas fa-satellite-dish"></i>Signal Source
            </h2>
            <p class="text-gray-400 mb-4">
              Generate a signal from an ally or a potential adversary to begin
              the verification process.
            </p>
            <div class="flex space-x-4">
              <button id="ally-signal-btn" class="btn btn-ally w-full">
                <i class="fas fa-shield-halved mr-2"></i>Generate Ally Signal
              </button>
              <button
                id="adversary-signal-btn"
                class="btn btn-adversary w-full"
              >
                <i class="fas fa-skull-crossbones mr-2"></i>Generate Adversary
                Signal
              </button>
            </div>
          </div>

          <!-- Fingerprint Module -->
          <div class="card">
            <h2 class="card-title">
              <i class="fas fa-fingerprint"></i>Fingerprint Module
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <!-- Signal Characteristics -->
              <div>
                <h3 class="font-semibold text-white mb-3">
                  Extracted Characteristics
                </h3>
                <div class="space-y-3">
                  <div class="flex justify-between items-center">
                    <span
                      ><i class="fas fa-clock w-5 text-gray-500 mr-1"></i>Timing
                      (T)</span
                    ><span id="timing-val" class="param-value">0.00</span>
                  </div>
                  <div class="flex justify-between items-center">
                    <span
                      ><i class="fas fa-wave-square w-5 text-gray-500 mr-1"></i
                      >Frequency (Freq)</span
                    ><span id="freq-val" class="param-value">0.00</span>
                  </div>
                  <div class="flex justify-between items-center">
                    <span
                      ><i class="fas fa-tags w-5 text-gray-500 mr-1"></i
                      >Metadata (Meta)</span
                    ><span id="meta-val" class="param-value">0.00</span>
                  </div>
                  <div class="flex justify-between items-center">
                    <span
                      ><i class="fas fa-chart-line w-5 text-gray-500 mr-1"></i
                      >Phase</span
                    ><span id="phase-val" class="param-value">0.00</span>
                  </div>
                </div>
              </div>
              <!-- Weights -->
              <div>
                <h3 class="font-semibold text-white mb-3">ML Model Weights</h3>
                <div class="space-y-3">
                  <div>
                    <label for="w1" class="text-sm"
                      >Weight 1 (Timing): <span id="w1-val">0.40</span></label
                    >
                    <input
                      type="range"
                      id="w1"
                      min="0"
                      max="1"
                      step="0.01"
                      value="0.4"
                    />
                  </div>
                  <div>
                    <label for="w2" class="text-sm"
                      >Weight 2 (Freq): <span id="w2-val">0.30</span></label
                    >
                    <input
                      type="range"
                      id="w2"
                      min="0"
                      max="1"
                      step="0.01"
                      value="0.3"
                    />
                  </div>
                  <div>
                    <label for="w3" class="text-sm"
                      >Weight 3 (Meta): <span id="w3-val">0.20</span></label
                    >
                    <input
                      type="range"
                      id="w3"
                      min="0"
                      max="1"
                      step="0.01"
                      value="0.2"
                    />
                  </div>
                  <div>
                    <label for="w4" class="text-sm"
                      >Weight 4 (Phase): <span id="w4-val">0.10</span></label
                    >
                    <input
                      type="range"
                      id="w4"
                      min="0"
                      max="1"
                      step="0.01"
                      value="0.1"
                    />
                  </div>
                </div>
              </div>
            </div>
            <!-- Formula & Result -->
            <div class="mt-6">
              <h3 class="font-semibold text-white mb-2">
                Signal Fingerprint (F)
              </h3>
              <div class="formula text-center">
                <p class="text-sm">F = w1*T + w2*Freq + w3*Meta + w4*Phase</p>
                <p
                  class="text-2xl font-bold mt-2 text-white"
                  id="fingerprint-result"
                >
                  0.00
                </p>
              </div>
            </div>
          </div>
        </div>

        <!-- Right Column: Verification & Output -->
        <div class="space-y-6">
          <!-- Verification -->
          <div class="card">
            <h2 class="card-title">
              <i class="fas fa-user-check"></i>Verification Status
            </h2>
            <div id="status-box" class="status-badge status-pending mx-auto">
              <span id="status-text">Awaiting Signal...</span>
            </div>
            <p
              id="status-reason"
              class="text-center text-gray-400 mt-4 text-sm"
            ></p>
          </div>

          <!-- Fingerprint Database -->
          <div class="card">
            <h2 class="card-title">
              <i class="fas fa-database"></i>Encrypted Fingerprint DB
            </h2>
            <div id="db-list" class="space-y-2 max-h-48 overflow-y-auto pr-2">
              <!-- DB entries will be populated by JS -->
            </div>
            <button id="learn-btn" class="btn btn-learn w-full mt-4" disabled>
              <i class="fas fa-brain mr-2"></i>Update DB from Signal
            </button>
          </div>

          <!-- Command Unit -->
          <div class="card">
            <h2 class="card-title">
              <i class="fas fa-cogs"></i>Command Processing Unit
            </h2>
            <div class="text-center">
              <i
                id="uav-icon"
                class="fas fa-drone fa-5x text-gray-600 uav-icon"
              ></i>
              <p id="cpu-log" class="mt-4 text-white font-semibold">Idle</p>
              <p id="cpu-subtext" class="text-gray-400 text-sm">
                Awaiting approved command signal.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // --- DOM Elements ---
      const elements = {
        timingVal: document.getElementById("timing-val"),
        freqVal: document.getElementById("freq-val"),
        metaVal: document.getElementById("meta-val"),
        phaseVal: document.getElementById("phase-val"),
        w1Val: document.getElementById("w1-val"),
        w2Val: document.getElementById("w2-val"),
        w3Val: document.getElementById("w3-val"),
        w4Val: document.getElementById("w4-val"),
        w1Slider: document.getElementById("w1"),
        w2Slider: document.getElementById("w2"),
        w3Slider: document.getElementById("w3"),
        w4Slider: document.getElementById("w4"),
        fingerprintResult: document.getElementById("fingerprint-result"),
        statusBox: document.getElementById("status-box"),
        statusText: document.getElementById("status-text"),
        statusReason: document.getElementById("status-reason"),
        dbList: document.getElementById("db-list"),
        learnBtn: document.getElementById("learn-btn"),
        cpuLog: document.getElementById("cpu-log"),
        cpuSubtext: document.getElementById("cpu-subtext"),
        uavIcon: document.getElementById("uav-icon"),
        allySignalBtn: document.getElementById("ally-signal-btn"),
        adversarySignalBtn: document.getElementById("adversary-signal-btn"),
      };

      // --- State ---
      let state = {
        weights: { w1: 0.4, w2: 0.3, w3: 0.2, w4: 0.1 },
        // Database of known 'good' fingerprint scores.
        database: [250.5, 310.2, 285.8],
        // Current signal being processed
        currentSignal: null,
        // Tolerance for matching fingerprints
        tolerance: 20.0,
      };

      // --- Utility Functions ---
      /**
       * Generates a random number within a given range.
       * @param {number} min - The minimum value.
       * @param {number} max - The maximum value.
       * @returns {number} A random number.
       */
      const getRandom = (min, max) => Math.random() * (max - min) + min;

      // --- Core Logic ---

      /**
       * Generates a signal object with parameters.
       * @param {boolean} isAlly - If true, generates parameters within a 'good' range.
       */
      function generateSignal(isAlly) {
        if (isAlly) {
          state.currentSignal = {
            T: getRandom(100, 150),
            Freq: getRandom(200, 250),
            Meta: getRandom(500, 550),
            Phase: getRandom(80, 120),
          };
        } else {
          // Adversary signals have at least one parameter out of the ordinary range.
          state.currentSignal = {
            T: getRandom(50, 250),
            Freq: getRandom(150, 350),
            Meta: getRandom(400, 700),
            Phase: getRandom(10, 200),
          };
          // Ensure at least one value is significantly different
          const paramToSkew = ["T", "Freq", "Meta", "Phase"][
            Math.floor(Math.random() * 4)
          ];
          state.currentSignal[paramToSkew] *= Math.random() > 0.5 ? 1.5 : 0.5;
        }
        elements.learnBtn.disabled = false;
        processSignal();
      }

      /**
       * Calculates the fingerprint score based on the current signal and weights.
       * @returns {number} The calculated fingerprint score.
       */
      function calculateFingerprint() {
        if (!state.currentSignal) return 0;
        const { T, Freq, Meta, Phase } = state.currentSignal;
        const { w1, w2, w3, w4 } = state.weights;
        return T * w1 + Freq * w2 + Meta * w3 + Phase * w4;
      }

      /**
       * Verifies the fingerprint against the database.
       * @param {number} fingerprint - The fingerprint score to verify.
       * @returns {boolean} True if the fingerprint is approved, false otherwise.
       */
      function verifyFingerprint(fingerprint) {
        return state.database.some(
          (dbEntry) => Math.abs(dbEntry - fingerprint) <= state.tolerance
        );
      }

      /**
       * Adds the current signal's fingerprint to the database.
       */
      function learnFromSignal() {
        if (!state.currentSignal) return;
        const fingerprint = calculateFingerprint();
        if (!state.database.includes(fingerprint)) {
          state.database.push(fingerprint);
          updateDatabaseUI();
          // Re-verify the signal with the updated database
          processSignal();
        }
      }

      /**
       * Takes the current signal and runs it through the full verification process.
       */
      function processSignal() {
        const fingerprint = calculateFingerprint();
        const isApproved = verifyFingerprint(fingerprint);
        updateSignalUI();
        updateFingerprintUI(fingerprint);
        updateStatusUI(isApproved, fingerprint);
        updateCpuUI(isApproved);
      }

      // --- UI Update Functions ---

      function updateSignalUI() {
        if (!state.currentSignal) return;
        const { T, Freq, Meta, Phase } = state.currentSignal;
        elements.timingVal.textContent = T.toFixed(2);
        elements.freqVal.textContent = Freq.toFixed(2);
        elements.metaVal.textContent = Meta.toFixed(2);
        elements.phaseVal.textContent = Phase.toFixed(2);
      }

      function updateWeightsUI() {
        elements.w1Val.textContent = state.weights.w1.toFixed(2);
        elements.w2Val.textContent = state.weights.w2.toFixed(2);
        elements.w3Val.textContent = state.weights.w3.toFixed(2);
        elements.w4Val.textContent = state.weights.w4.toFixed(2);
        elements.w1Slider.value = state.weights.w1;
        elements.w2Slider.value = state.weights.w2;
        elements.w3Slider.value = state.weights.w3;
        elements.w4Slider.value = state.weights.w4;
      }

      function updateFingerprintUI(fingerprint) {
        elements.fingerprintResult.textContent = fingerprint.toFixed(2);
      }

      function updateStatusUI(isApproved, fingerprint) {
        elements.statusBox.className = "status-badge"; // Reset classes
        if (isApproved) {
          elements.statusBox.classList.add("status-approved");
          elements.statusText.textContent = "Approved";
          elements.statusReason.textContent = `Fingerprint ${fingerprint.toFixed(
            2
          )} is within tolerance of a known signal.`;
        } else {
          elements.statusBox.classList.add("status-deceptive");
          elements.statusText.textContent = "Deceptive Signal";
          elements.statusReason.textContent = `Fingerprint ${fingerprint.toFixed(
            2
          )} does not match any known authorized signal.`;
        }
      }

      function updateCpuUI(isApproved) {
        if (isApproved) {
          elements.cpuLog.textContent = "Command Processed";
          elements.cpuSubtext.textContent = "Valid commands sent to UAV.";
          elements.uavIcon.classList.add("uav-active");
        } else {
          elements.cpuLog.textContent = "Command Blocked";
          elements.cpuSubtext.textContent = "Signal rejected. No action taken.";
          elements.uavIcon.classList.remove("uav-active");
        }
      }

      function updateDatabaseUI() {
        elements.dbList.innerHTML = "";
        state.database.forEach((fp) => {
          const div = document.createElement("div");
          div.className = "db-entry";
          div.textContent = fp.toFixed(2);
          elements.dbList.appendChild(div);
        });
      }

      // --- Event Listeners ---
      elements.allySignalBtn.addEventListener("click", () =>
        generateSignal(true)
      );
      elements.adversarySignalBtn.addEventListener("click", () =>
        generateSignal(false)
      );
      elements.learnBtn.addEventListener("click", learnFromSignal);

      [
        elements.w1Slider,
        elements.w2Slider,
        elements.w3Slider,
        elements.w4Slider,
      ].forEach((slider) => {
        slider.addEventListener("input", (e) => {
          state.weights[e.target.id] = parseFloat(e.target.value);
          updateWeightsUI();
          if (state.currentSignal) {
            processSignal();
          }
        });
      });

      // --- Initial Load ---
      window.onload = () => {
        updateWeightsUI();
        updateDatabaseUI();
      };
    </script>
  </body>
</html>
